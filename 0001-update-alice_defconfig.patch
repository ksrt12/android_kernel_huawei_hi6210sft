From a694e5b7b06c5afd10a419223e86b97a688b0bf2 Mon Sep 17 00:00:00 2001
From: Kazakov Stepan <kazakov12stepan2012@live.ru>
Date: Fri, 20 Apr 2018 20:05:59 +0300
Subject: [PATCH] update alice_defconfig

---
 arch/arm64/configs/alice_defconfig          | 48 +++++++++++----------
 drivers/gpu/arm/mali4_64/r6p0-01rel0/Kbuild |  5 ++-
 2 files changed, 30 insertions(+), 23 deletions(-)

diff --git a/arch/arm64/configs/alice_defconfig b/arch/arm64/configs/alice_defconfig
index fa24c627..38f6be24 100644
--- a/arch/arm64/configs/alice_defconfig
+++ b/arch/arm64/configs/alice_defconfig
@@ -36,7 +36,7 @@ CONFIG_BUILDTIME_EXTABLE_SORT=y
 #
 CONFIG_INIT_ENV_ARG_LIMIT=32
 CONFIG_CROSS_COMPILE=""
-CONFIG_LOCALVERSION=""
+CONFIG_LOCALVERSION="-alice"
 CONFIG_LOCALVERSION_AUTO=y
 CONFIG_DEFAULT_HOSTNAME="(none)"
 CONFIG_SWAP=y
@@ -229,15 +229,16 @@ CONFIG_BLOCK_COMPAT=y
 # IO Schedulers
 #
 CONFIG_IOSCHED_NOOP=y
-# CONFIG_IOSCHED_DEADLINE is not set
+CONFIG_IOSCHED_DEADLINE=y
 CONFIG_IOSCHED_CFQ=y
 CONFIG_IOSCHED_FIOPS=y
 CONFIG_IOSCHED_ZEN=y
-CONFIG_DEFAULT_CFQ=y
+# CONFIG_DEFAULT_DEADLINE is not set
+# CONFIG_DEFAULT_CFQ is not set
 # CONFIG_DEFAULT_NOOP is not set
 # CONFIG_DEFAULT_FIOPS is not set
-# CONFIG_DEFAULT_ZEN is not set
-CONFIG_DEFAULT_IOSCHED="cfq"
+CONFIG_DEFAULT_ZEN=y
+CONFIG_DEFAULT_IOSCHED="zen"
 CONFIG_UNINLINE_SPIN_UNLOCK=y
 CONFIG_ARCH_SUPPORTS_ATOMIC_RMW=y
 CONFIG_MUTEX_SPIN_ON_OWNER=y
@@ -282,7 +283,7 @@ CONFIG_HMP_SLOW_CPU_MASK=""
 CONFIG_HMP_VARIABLE_SCALE=y
 CONFIG_HMP_FREQUENCY_INVARIANT_SCALE=y
 # CONFIG_SCHED_HMP_LITTLE_PACKING is not set
-# CONFIG_SCHED_HMP_BOOST is not set
+CONFIG_SCHED_HMP_BOOST=y
 CONFIG_NR_CPUS=8
 CONFIG_HOTPLUG_CPU=y
 CONFIG_SWP_EMULATE=y
@@ -335,7 +336,7 @@ CONFIG_HISI_MNTN=y
 # CONFIG_DEBUG_VMALLOC is not set
 CONFIG_ZPOOL=y
 CONFIG_ZSMALLOC=y
-# CONFIG_PGTABLE_MAPPING is not set
+CONFIG_PGTABLE_MAPPING=y
 # CONFIG_ZSMALLOC_STAT is not set
 CONFIG_FORCE_MAX_ZONEORDER=11
 CONFIG_SECCOMP=y
@@ -394,20 +395,20 @@ CONFIG_CPU_FREQ_TABLE=y
 CONFIG_CPU_FREQ_GOV_COMMON=y
 CONFIG_CPU_FREQ_STAT=y
 # CONFIG_CPU_FREQ_STAT_DETAILS is not set
-CONFIG_CPU_FREQ_DEFAULT_GOV_PERFORMANCE=y
+# CONFIG_CPU_FREQ_DEFAULT_GOV_PERFORMANCE is not set
 # CONFIG_CPU_FREQ_DEFAULT_GOV_POWERSAVE is not set
 # CONFIG_CPU_FREQ_DEFAULT_GOV_USERSPACE is not set
 # CONFIG_CPU_FREQ_DEFAULT_GOV_ONDEMAND is not set
 # CONFIG_CPU_FREQ_DEFAULT_GOV_CONSERVATIVE is not set
-# CONFIG_CPU_FREQ_DEFAULT_GOV_INTERACTIVE is not set
+CONFIG_CPU_FREQ_DEFAULT_GOV_INTERACTIVE=y
 # CONFIG_CPU_FREQ_DEFAULT_GOV_OPTDEMAND is not set
 CONFIG_CPU_FREQ_GOV_PERFORMANCE=y
-# CONFIG_CPU_FREQ_GOV_POWERSAVE is not set
-# CONFIG_CPU_FREQ_GOV_USERSPACE is not set
-# CONFIG_CPU_FREQ_GOV_ONDEMAND is not set
-# CONFIG_CPU_FREQ_GOV_INTERACTIVE is not set
+CONFIG_CPU_FREQ_GOV_POWERSAVE=y
+CONFIG_CPU_FREQ_GOV_USERSPACE=y
+CONFIG_CPU_FREQ_GOV_ONDEMAND=y
+CONFIG_CPU_FREQ_GOV_INTERACTIVE=y
 CONFIG_INPUT_PULSE_SUPPORT=y
-# CONFIG_CPU_FREQ_GOV_CONSERVATIVE is not set
+CONFIG_CPU_FREQ_GOV_CONSERVATIVE=y
 CONFIG_CPU_FREQ_GOV_OPTDEMAND=y
 # CONFIG_GENERIC_CPUFREQ_CPU0 is not set
 
@@ -423,7 +424,7 @@ CONFIG_CPU_FREQ_GOV_OPTDEMAND=y
 CONFIG_HI6XXX_CPUFREQ=y
 CONFIG_HI6XXX_DT_CPUFREQ=y
 CONFIG_HISI_CPUFREQ=y
-# CONFIG_CPU_FREQ_NEW_TABLE is not set
+CONFIG_CPU_FREQ_NEW_TABLE=y
 CONFIG_ARCH_SUSPEND_POSSIBLE=y
 CONFIG_ARM64_CPU_SUSPEND=y
 
@@ -1193,8 +1194,11 @@ CONFIG_PPPOLAC=y
 CONFIG_PPPOPNS=y
 CONFIG_PPP_ASYNC=y
 CONFIG_PPP_SYNC_TTY=y
-# CONFIG_SLIP is not set
+CONFIG_SLIP=y
 CONFIG_SLHC=y
+# CONFIG_SLIP_COMPRESSED is not set
+# CONFIG_SLIP_SMART is not set
+# CONFIG_SLIP_MODE_SLIP6 is not set
 
 #
 # USB Network Adapters
@@ -1243,8 +1247,8 @@ CONFIG_INPUT_MOUSEDEV_SCREEN_Y=768
 # CONFIG_INPUT_JOYDEV is not set
 CONFIG_INPUT_EVDEV=y
 # CONFIG_INPUT_EVBUG is not set
-CONFIG_INPUT_KEYRESET=y
-CONFIG_INPUT_KEYCOMBO=y
+# CONFIG_INPUT_KEYRESET is not set
+# CONFIG_INPUT_KEYCOMBO is not set
 
 #
 # Input Device Drivers
@@ -2056,7 +2060,7 @@ CONFIG_USB=y
 #
 # CONFIG_USB_DEFAULT_PERSIST is not set
 # CONFIG_USB_DYNAMIC_MINORS is not set
-# CONFIG_USB_OTG is not set
+CONFIG_USB_OTG=y
 # CONFIG_USB_OTG_WHITELIST is not set
 # CONFIG_USB_OTG_BLACKLIST_HUB is not set
 # CONFIG_USB_MON is not set
@@ -2193,7 +2197,7 @@ CONFIG_USB_G_ANDROID=y
 # CONFIG_USB_G_HID is not set
 # CONFIG_USB_G_DBGP is not set
 # CONFIG_USB_G_WEBCAM is not set
-CONFIG_HUAWEI_USB_OTGSWITCH=y
+# CONFIG_HUAWEI_USB_OTGSWITCH is not set
 CONFIG_MMC=y
 # CONFIG_MMC_DEBUG is not set
 CONFIG_HUAWEI_SDCARD_DSM=y
@@ -2583,7 +2587,7 @@ CONFIG_HISILICON_PLATFORM_SYNC=y
 CONFIG_HISILICON_PLATFORM_NVIM=y
 CONFIG_HISILICON_PLATFORM_NVE=y
 CONFIG_HISILICON_PLATFORM_UDI=y
-# CONFIG_HISILICON_PLATFORM_USB is not set
+CONFIG_HISILICON_PLATFORM_USB=y
 
 #
 # Hisi Modem
@@ -2861,7 +2865,7 @@ CONFIG_SWITCH_FSA9685=y
 # CONFIG_SWITCH_USB is not set
 CONFIG_SWITCH_USB_CLS=y
 CONFIG_FSA9685_DEBUG_FS=y
-# CONFIG_SWITCH_OTGID_GPIO is not set
+CONFIG_SWITCH_OTGID_GPIO=y
 # CONFIG_HUAWEI_TYPEC is not set
 # CONFIG_HUAWEI_TYPEC_PERICOM30216 is not set
 # CONFIG_HUAWEI_TYPEC_TUSB320 is not set
diff --git a/drivers/gpu/arm/mali4_64/r6p0-01rel0/Kbuild b/drivers/gpu/arm/mali4_64/r6p0-01rel0/Kbuild
index 090a0bbf..6e86179e 100755
--- a/drivers/gpu/arm/mali4_64/r6p0-01rel0/Kbuild
+++ b/drivers/gpu/arm/mali4_64/r6p0-01rel0/Kbuild
@@ -31,7 +31,10 @@ CONFIG_MALI400_DEBUG := n
 CONFIG_MALI_SHARED_INTERRUPTS :=y
 CONFIG_MALI450 :=y
 CONFIG_MALI_DMA_BUF_MAP_ON_ATTACH:=y
-CONFIG_MALI_DVFS := y
+CONFIG_MALI_DVFS ?= y
+ifeq ($(CONFIG_HI1101_WIFI),y)
+CONFIG_MALI_DVFS := n
+endif
 
 # For customer releases the Linux Device Drivers will be provided as ARM proprietary and GPL releases:
 # The ARM proprietary product will only include the license/proprietary directory
-- 
2.19.1

